<!doctype html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>CMS</title>
    <!-- HEAD 안 -->
<style id="cms-fixes">
  /* 문서 전체는 자연 스크롤 */
  html, body { height: auto !important; }
  body { overflow: auto !important; overscroll-behavior: none; }

  /* CMS 루트는 화면 높이만큼 최소 확보 */
  #nc-root { min-height: 100vh; position: relative; }

  /* Decap 내부 스크롤 컨테이너들의 오버플로우를 풀고
     바닥에 넉넉한 여유 공간을 둬서 더 로우를 붙일 수 있게 한다 */
  #nc-root .Pane-content,
  #nc-root [data-testid="collection-page"],
  #nc-root main[role="main"] {
    overflow: visible !important;
    padding-bottom: 1600px;   /* 여유 공간 */
  }

  /* 아주 아래에 스페이서 추가 (센티널 역할) */
  #nc-root .Pane-content::after,
  #nc-root [data-testid="collection-page"]::after,
  #nc-root main[role="main"]::after {
    content: "";
    display: block;
    height: 1600px;
  }
</style>
  </head>
  <body>
    <!-- ✅ Decap가 여기에 렌더링한다 -->
    <div id="nc-root"></div>

    <!-- (선택) Netlify Identity 위젯 -->
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>

    <!-- ✅ Decap CMS v3 core -->
    <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script>

    <!-- ✅ Netlify(= git-gateway) 백엔드 플러그인 -->
    <script src="https://unpkg.com/decap-cms-backend-netlify@^3.0.0/dist/standalone.js"></script>

    <!-- 자동 초기화가 기본값이라 따로 CMS.init()는 보통 필요 없음 -->

    <script>
      // Decap가 화면에 올라온 뒤, 스크롤 이벤트를 여러 번 발생시켜
      // 가상 리스트가 추가 로우를 로드하도록 유도
      (function () {
        function ping() {
          try {
            var de = document.scrollingElement || document.documentElement;
            var t = de.scrollTop;
            de.scrollTop = t + 300;
            window.dispatchEvent(new Event('scroll'));
            de.scrollTop = t;
            window.dispatchEvent(new Event('scroll'));
          } catch (e) {}
        }

        function untilStable(maxTries) {
          var tries = 0, lastH = -1, same = 0;
          var timer = setInterval(function () {
            var h = document.body.scrollHeight;
            if (h === lastH) same++; else same = 0;
            lastH = h;
            ping();
            tries++;
            if (same > 10 || tries > (maxTries || 180)) clearInterval(timer);
          }, 50);
        }

        if (document.readyState === 'loading') {
          document.addEventListener('DOMContentLoaded', function(){
            setTimeout(untilStable, 150);
          });
        } else {
          setTimeout(untilStable, 150);
        }
      })();
    </script>
  </body>
</html>